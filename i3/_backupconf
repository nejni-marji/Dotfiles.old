#
# ~/.i3/config
#

# vim:fdm=marker:
# i3 config file (v4)

# {{{ ipc scripts
	# generic
	exec_always $i3b/i3ipc_nop.py
	bindsym $MOD+equal      nop ipc resize grow
	bindsym $MOD+$SHF+equal nop ipc resize shrink
	# flatten
	bindsym $MOD+$ALT+g     nop ipc flatten arg
	# hotswap
	exec_always $i3b/hotswap.py
	bindsym $MOD+$SHF+m nop ipc hotswap swapthis
	bindsym $MOD+m      nop ipc hotswap swaphere
	bindsym $MOD+$ALT+m nop ipc hotswap return
	bindsym $MOD+$CTL+m nop ipc hotswap reset
# }}}
# {{{ i3-gaps only
	smart_gaps on
	gaps inner $gaps_inner
	gaps outer $gaps_outer
# }}}
# {{{ set general variables
	# {{{ modifiers
		set $MOD Mod4
		set $ALT Mod1
		set $CTL Control
		set $SHF Shift
	# }}}
	set $exec exec --no-startup-id
	set $nsi --no-startup-id
	set $i3b ~/.i3/bin
	set $lock exec --no-startup-id ~/.i3/dynami3/bin/lock_dynami3.sh set
# }}}
# {{{ startup
	exec_always $nsi $i3b/set_wallpaper.sh
	exec_always $nsi i3-msg rename workspace 1 to $w1 # always
	$exec $i3b/manager.sh init
# }}}
# {{{ workspace, assign, for_window
	# {{{ workspace variables
		set $w1 1:Web
		set $w2 2:Code
		set $w3 3:Misc
		set $w4 4:School
		set $w5 5:Chat
		set $w6 6:Steam
		set $w7 7
		set $w8 8
		set $w9 9
		set $w0 10:Test
	# }}}
	# {{{ assign
		# 3
		assign [class="Deluge"] $w3
		assign [class="Gimp"] $w3
		assign [title="^Oracle VM VirtualBox Manager$"] $w3
		# 4
		assign [title="^School \[\w+\] - Oracle VM VirtualBox"] $w4
		# 5
		assign [class="TelegramDesktop"] $w5
		assign [class="discord"] $w5
		# 6
		assign [class="Steam"] $w6
		assign [title="Steam"] $w6
	# }}}
	# {{{ for_window
		for_window [title="^vimpc$"] floating enable, sticky enable
		for_window [class="Pavucontrol"] floating enable, sticky enable
		for_window [title="^pulsemixer$"] floating enable, sticky enable
	# }}}
# }}}
# {{{ appearance
	# {{{ window decorations
		for_window [class=".*"] border $borders
		new_window $borders
		new_float $borders
		font pango:$font
	# }}}
	# {{{ color variables
		# [E]dge, [B]ody, [T]ext
		# edges are set with di3:core/vars, this is just reference
		# focused
		set $c_focusE #600060
		set $c_focusB #800080
		set $c_focusT #ffffff
		# inactive
		set $c_inactE #606060
		set $c_inactB #808080
		set $c_inactT #ffffff
		# unfocused
		set $c_unfocE #303030
		set $c_unfocB #404040
		set $c_unfocT #aaaaaa
		# urgent
		set $c_urgenE #c06000
		set $c_urgenB #ff8000
		set $c_urgenT #000000
		# bind indicator
		set $c_bindmE #00ff80
		set $c_bindmB #00ff80
		set $c_bindmT #000000
		# splits are [A]ll the same
		set $c_splitA #00ff80
		# i3bar: separator, background, text
		set $c_i3barE #ff8000ff
		set $c_i3barB #00000080
		set $c_i3barT #ffffffff
	# }}}
	# {{{ window colors
		#                       #edges    #body     #text     #split
		client.focused          $c_focusE $c_focusB $c_focusT $c_splitA
		client.focused_inactive $c_inactE $c_inactB $c_inactT $c_splitA
		client.unfocused        $c_unfocE $c_unfocB $c_unfocT $c_splitA
		client.urgent           $c_urgenE $c_urgenB $c_urgenT $c_splitA
	# }}}
	# {{{ i3bar
		bindsym $MOD+b      bar mode toggle;         $lock bar_mode
		bindsym $MOD+$SHF+b bar hidden_state toggle; $lock bar_hide
		bar {
			font pango:monospace 8
			mode $bar_mode
			hidden_state $bar_hide
			modifier $bar_key
			i3bar_command i3bar -t
			status_command i3blocks
			strip_workspace_numbers yes
			tray_output primary
			tray_padding 0
			colors { # {{{
				background $c_i3barB
				statusline $c_i3barT
				separator  $c_i3barE
				#                  #edges    #body     #text
				focused_workspace  $c_focusB $c_focusB $c_focusT
				inactive_workspace $c_unfocB $c_unfocB $c_focusT
				urgent_workspace   $c_urgenB $c_urgenB $c_urgenT
				binding_mode       $c_bindmB $c_bindmB $c_bindmT
			} # }}}
		}
	# }}}
# }}}
# {{{ general settings
	floating_maximum_size 1000x750
	floating_minimum_size 300x350
	workspace_layout stacking
	workspace_auto_back_and_forth yes
	hide_edge_borders smart
# }}}
# {{{ i3 controls
	bindsym $MOD+c       $exec $i3b/manager.sh reload
	bindsym $MOD+r       $exec $i3b/manager.sh restart
	bindsym $MOD+$SHF+q kill
	bindsym $MOD+$SHF+$CTL+q $exec "i3-nagbar \
	-t warning -m 'Exit i3?' \
	-b 'Yes, exit i3' '$i3b/manager.sh exit'
	# misc
	bindsym $MOD+d      $exec $i3b/date_notify.sh
	bindsym $MOD+$SHF+d $exec $i3b/web_search.sh
	bindsym $MOD+$ALT+d $exec $i3b/web_search.sh !ddgi
# }}}
# {{{ movement
	# {{{ workspaces
		bindsym $MOD+z                 workspace back_and_forth
		bindsym $MOD+$SHF+z            move container to workspace back_and_forth
		bindsym $MOD+$ALT+z            [urgent=latest] focus
		bindsym $MOD+$SHF+$ALT+z       [urgent=oldest] focus
		bindsym $MOD+bracketleft       workspace prev_on_output
		bindsym $MOD+bracketright      workspace next_on_output
		bindsym $MOD+$SHF+bracketleft  workspace prev
		bindsym $MOD+$SHF+bracketright workspace next
		bindsym $MOD+1                 workspace number $w1
		bindsym $MOD+2                 workspace number $w2
		bindsym $MOD+3                 workspace number $w3
		bindsym $MOD+4                 workspace number $w4
		bindsym $MOD+5                 workspace number $w5
		bindsym $MOD+6                 workspace number $w6
		bindsym $MOD+7                 workspace number $w7
		bindsym $MOD+8                 workspace number $w8
		bindsym $MOD+9                 workspace number $w9
		bindsym $MOD+0                 workspace number $w0
		bindsym $MOD+$SHF+1            move container to workspace number $w1
		bindsym $MOD+$SHF+2            move container to workspace number $w2
		bindsym $MOD+$SHF+3            move container to workspace number $w3
		bindsym $MOD+$SHF+4            move container to workspace number $w4
		bindsym $MOD+$SHF+5            move container to workspace number $w5
		bindsym $MOD+$SHF+6            move container to workspace number $w6
		bindsym $MOD+$SHF+7            move container to workspace number $w7
		bindsym $MOD+$SHF+8            move container to workspace number $w8
		bindsym $MOD+$SHF+9            move container to workspace number $w9
		bindsym $MOD+$SHF+0            move container to workspace number $w0
	# }}}
	# {{{ directionals
		# focus
		bindsym $MOD+h      focus left
		bindsym $MOD+j      focus down
		bindsym $MOD+k      focus up
		bindsym $MOD+l      focus right
		# move
		bindsym $MOD+$SHF+h move left
		bindsym $MOD+$SHF+j move down
		bindsym $MOD+$SHF+k move up
		bindsym $MOD+$SHF+l move right
		# swap
		bindsym $MOD+$ALT+h mark --add _dirswap_a; focus left;  mark --add _dirswap_b; swap container with mark _dirswap_a; [con_mark="^_dirswap_a$"] focus; unmark _dirswap_a; unmark _dirswap_b
		bindsym $MOD+$ALT+j mark --add _dirswap_a; focus down;  mark --add _dirswap_b; swap container with mark _dirswap_a; [con_mark="^_dirswap_a$"] focus; unmark _dirswap_a; unmark _dirswap_b
		bindsym $MOD+$ALT+k mark --add _dirswap_a; focus up;    mark --add _dirswap_b; swap container with mark _dirswap_a; [con_mark="^_dirswap_a$"] focus; unmark _dirswap_a; unmark _dirswap_b
		bindsym $MOD+$ALT+l mark --add _dirswap_a; focus right; mark --add _dirswap_b; swap container with mark _dirswap_a; [con_mark="^_dirswap_a$"] focus; unmark _dirswap_a; unmark _dirswap_b
		bindsym $MOD+$SHF+$ALT+h mark --add _dirswap_a; focus left;  mark --add _dirswap_b; swap container with mark _dirswap_a; unmark _dirswap_a; unmark _dirswap_b
		bindsym $MOD+$SHF+$ALT+j mark --add _dirswap_a; focus down;  mark --add _dirswap_b; swap container with mark _dirswap_a; unmark _dirswap_a; unmark _dirswap_b
		bindsym $MOD+$SHF+$ALT+k mark --add _dirswap_a; focus up;    mark --add _dirswap_b; swap container with mark _dirswap_a; unmark _dirswap_a; unmark _dirswap_b
		bindsym $MOD+$SHF+$ALT+l mark --add _dirswap_a; focus right; mark --add _dirswap_b; swap container with mark _dirswap_a; unmark _dirswap_a; unmark _dirswap_b
		# fullscreen
		bindsym $MOD+$CTL+h fullscreen disable; focus left;  fullscreen enable
		bindsym $MOD+$CTL+j fullscreen disable; focus down;  fullscreen enable
		bindsym $MOD+$CTL+k fullscreen disable; focus up;    fullscreen enable
		bindsym $MOD+$CTL+l fullscreen disable; focus right; fullscreen enable
	# }}}
	# {{{ tree
		bindsym $MOD+g          focus parent
		bindsym $MOD+$SHF+g     focus child
		bindsym $MOD+f          fullscreen
		bindsym $MOD+$SHF+f     fullscreen global
		bindsym $MOD+$ALT+f     focus parent; fullscreen; focus child
		# splits
		bindsym $MOD+t          layout stacking
		bindsym $MOD+$SHF+t     layout tabbed
		bindsym $MOD+n          layout splitv
		bindsym $MOD+$SHF+n     layout splith
		bindsym $MOD+w          split t; layout stacking
		bindsym $MOD+$SHF+w     split t; layout tabbed
		bindsym $MOD+v          split v
		bindsym $MOD+$SHF+v     split h
	# }}}
	# {{{ floating
		floating_modifier $MOD
		bindsym $MOD+s          focus mode_toggle
		bindsym $MOD+$SHF+s     floating toggle
		bindsym $MOD+$ALT+s     sticky toggle
	# }}}
	# {{{ scratchpad
		bindsym $MOD+$SHF+minus move scratchpad
		bindsym $MOD+minus           scratchpad show
	# }}}
# }}}
# {{{ summoners
	bindsym $MOD+$SHF+Return      $exec urxvt -e zsh
	bindsym $MOD+$CTL+Return      $exec urxvt -e tmx
	bindsym $MOD+$SHF+$CTL+Return $exec urxvt -e ranger
	bindsym $MOD+$ALT+Return      $exec cool-retro-term -e zsh
	# {{{ rofi
		bindsym $MOD+backslash      $exec rofi \
			-kb-row-select "Tab" -kb-row-tab "" \
			-modi run -show run
		bindsym $MOD+$SHF+backslash $exec rofi \
			-columns 1 \
			-kb-row-select "Tab" -kb-row-tab "" \
			-modi window -show window
	# }}}
# }}}
# {{{ media keys
	# {{{ screenshots
		set $print Print
		bindsym --release $print $exec ~/bin/shoot -s
		bindsym      $SHF+$print $exec ~/bin/shoot
		bindsym      $CTL+$print $exec ~/bin/shoot -u
	# }}}
	# {{{ audio and mpd with arrow keys
		#
		bindsym $MOD+Up         $exec ~/bin/sound pa  set +10
		bindsym $MOD+Down       $exec ~/bin/sound pa  set -10
		bindsym $MOD+Left       $exec ~/bin/sound pa  mute
		bindsym $MOD+Right      $exec ~/bin/sound mpd toggle
		#
		bindsym $MOD+$SHF+Up    $exec ~/bin/sound mpd vol +10
		bindsym $MOD+$SHF+Down  $exec ~/bin/sound mpd vol -10
		bindsym $MOD+$SHF+Left  $exec ~/bin/sound mpd prev
		bindsym $MOD+$SHF+Right $exec ~/bin/sound mpd next
		#
		bindsym $MOD+$ALT+Up    $exec ~/bin/sound nop
		bindsym $MOD+$ALT+Down  $exec ~/bin/sound mpd stop
		bindsym $MOD+$ALT+Left  $exec ~/bin/sound pa  get notify
		bindsym $MOD+$ALT+Right $exec ~/bin/sound mpd get
		#
		bindsym $MOD+$CTL+Up    $exec ~/bin/sound nop
		bindsym $MOD+$CTL+Down  $exec ~/bin/sound nop
		bindsym $MOD+$CTL+Left  $exec ~/bin/sound nop
		bindsym $MOD+$CTL+Right $exec ~/bin/sound nop
	# }}}
# }}}
# {{{ nop
	bindsym $MOD+$ALT+space        nop "Discord: push to talk"
	bindsym button9 --whole-window nop "libinput: trackball button scrolling"
# }}}



# End of config



# {{{ dynami3: core/vars #
	set $bar_mode dock
	set $bar_hide hide
	set $bar_key none
	set $gaps_inner 0
	set $gaps_outer 0
	set $borders normal 0
	set $font monospace 6
	set $c_focusE #800080
	set $c_inactE #808080
	set $c_unfocE #404040
	set $c_urgenE #ff8000
# }}} core/vars
# {{{ dynami3: vi3m #
	bindsym $mod+Return mode "R-"
	mode "R-" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "default"
		bindsym a mode "R-a"
		bindsym i mode "R-i"
		bindsym m mode "R-m"
		bindsym r mode "R-r"
		bindsym t mode "R-t"
		bindsym u mode "R-u"
		bindsym w mode "R-w"
		bindsym z mode "R-z"
	}
	
	mode "R-a" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym Shift+d $exec deluge-gtk; mode "default"
		bindsym Shift+f $exec firefox --private-window; mode "default"
		bindsym Shift+g $exec gimp ~/Pictures/Screenshots/Latest.png; mode "default"
		bindsym Shift+l $exec libreoffice; mode "default"
		bindsym Shift+v $exec vlc; mode "default"
		bindsym d $exec discord; mode "default"
		bindsym f $exec firefox; mode "default"
		bindsym g $exec gimp; mode "default"
		bindsym l $exec leafpad; mode "default"
		bindsym s $exec steam; mode "default"
		bindsym t $exec ~/bin/telegram; mode "default"
		bindsym v $exec VirtualBox; mode "default"
	}
	
	mode "R-i" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym Shift+f $lock gaps 0; $lock titlebars 0; $exec ~/.i3/bin/manager.sh restart; mode "default"
		bindsym Shift+l $exec ~/.i3/bin/autolock_locker.sh & zsh -c "sleep 60 && xset dpms force off"; mode "default"
		bindsym Shift+m $exec i3-input -P "unmark " -F "unmark %s"; mode "default"
		bindsym b mode "R-ib"
		bindsym c $lock colorclock; $exec ~/.i3/bin/manager.sh restart; mode "default"
		bindsym d $lock debugging; $exec ~/.i3/bin/manager.sh restart; mode "default"
		bindsym e mode "R-ie"
		bindsym f $lock gaps 1; $lock titlebars 1; $exec ~/.i3/bin/manager.sh restart; mode "default"
		bindsym g $lock gaps; $exec ~/.i3/bin/manager.sh restart; mode "default"
		bindsym i $exec i3-input; mode "default"
		bindsym l $exec ~/.i3/bin/autolock_locker.sh; mode "default"
		bindsym m $exec i3-input -P "mark " -F "mark %s"; mode "default"
		bindsym t $lock titlebars; $exec ~/.i3/bin/manager.sh restart; mode "default"
	}
	
	mode "R-ib" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-i"
		bindsym h $lock bar_hide; $exec ~/.i3/bin/manager.sh restart; mode "default"
		bindsym k $lock bar_key; $exec ~/.i3/bin/manager.sh restart; mode "default"
		bindsym m $lock bar_mode; $exec ~/.i3/bin/manager.sh restart; mode "default"
	}
	
	mode "R-ie" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-i"
		bindsym Shift+c $exec ~/.i3/bin/manager.sh edit true; mode "default"
		bindsym Shift+v $exec ~/.i3/bin/manager.sh edit vars; mode "default"
		bindsym c $exec ~/.i3/bin/manager.sh edit main; mode "default"
		bindsym m $exec ~/.i3/bin/manager.sh edit mngr; mode "default"
		bindsym v $exec ~/.i3/bin/manager.sh edit vi3m; mode "default"
	}
	
	mode "R-m" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym Shift+s $exec mpc stop && mpc -h odroid pause; mode "default"
		bindsym s $exec mpc stop; mode "default"
		bindsym t mode "R-mt"
		bindsym v $exec urxvt -e vimpc; mode "default"
	}
	
	mode "R-mt" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-m"
		bindsym c $exec ~/bin/sound mpd toggle consume; mode "default"
		bindsym e $exec ~/bin/sound mpd toggle repeat; mode "default"
		bindsym r $exec ~/bin/sound mpd toggle random; mode "default"
		bindsym s $exec ~/bin/sound mpd toggle single; mode "default"
	}
	
	mode "R-r" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym b $exec ~/bin/remote mosh bot -f -o cat -n 24; mode "default"
		bindsym d $exec ~/bin/remote tmuxd; mode "default"
		bindsym f $exec ~/bin/remote sshfs; mode "default"
		bindsym m $exec ~/bin/remote mosh; mode "default"
		bindsym p $exec ~/bin/remote ping; mode "default"
		bindsym r $exec ~/bin/remote ranger; mode "default"
		bindsym s $exec ~/bin/remote ssh; mode "default"
		bindsym t $exec ~/bin/remote tmux; mode "default"
		bindsym u $exec ~/bin/remote unmount; mode "default"
		bindsym v $exec ~/bin/remote vimpc; mode "default"
	}
	
	mode "R-t" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym Shift+c $exec zsh -c "pkill -x compton && compton -b || compton -b"; mode "default"
		bindsym Shift+r $exec zsh -c "pkill -x redshift-gtk && redshift -O 4500 || redshift -O 4500"; mode "default"
		bindsym b $exec zsh -c "pkill blueman-applet || blueman-applet"; mode "default"
		bindsym c $exec zsh -c "pkill -x compton || compton -b"; mode "default"
		bindsym r $exec zsh -c "pkill -x redshift-gtk && redshift -x || redshift-gtk"; mode "default"
	}
	
	mode "R-u" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym Shift+f $exec ~/bin/feshot all; mode "default"
		bindsym Shift+p $exec pavucontrol; mode "default"
		bindsym Shift+s $exec zsh -c "pkill -x sc-controller && pkill -x scc-daemon"; mode "default"
		bindsym f $exec ~/bin/feshot; mode "default"
		bindsym p $exec urxvt -e pulsemixer; mode "default"
		bindsym s $exec sc-controller && ~/bin/keyswitch; mode "default"
	}
	
	mode "R-w" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym m $exec i3-input -P "move to workspace " -F "move to workspace %s"; mode "default"
		bindsym o $exec i3-input -P "move workspace to output " -F "move workspace to output %s"; mode "default"
		bindsym r $exec i3-input -P "rename workspace to " -F "rename workspace to %s"; mode "default"
	}
	
	mode "R-z" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-"
		bindsym Shift+w [title="Wolfram\|Alpha(: Computational Intelligence)? - Mozilla Firefox$"] focus; $exec firefox wolframalpha.com; mode "default"
		bindsym d $exec firefox --new-window https://github.com/nejni-marji/Dotfiles; mode "default"
		bindsym i mode "R-zi"
		bindsym w $exec firefox --new-window wolframalpha.com; mode "default"
	}
	
	mode "R-zi" {
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym Control+c mode "default"
		bindsym Control+bracketleft mode "default"
		bindsym $mod+Return mode "default"
		bindsym BackSpace mode "R-z"
		bindsym f $exec ~/.i3/bin/misc/focus_iss.sh; mode "default"
		bindsym r $exec ~/.i3/bin/misc/reset_iss.sh; mode "default"
	}
	
# }}} vi3m
