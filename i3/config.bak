#
# ~/.i3/config
#

# vim:fdm=marker:
# i3 config file (v4)

# {{{ i3-gaps only
	smart_gaps on
# }}}
# {{{ set general variables
	set $mod Mod4
	set $alt Mod1
	set $exec exec --no-startup-id
	set $nsi --no-startup-id
	set $i3b ~/.i3/bin
# }}}
# {{{ startup
	exec_always $nsi $i3b/set_wallpaper.sh
	exec_always $nsi i3-msg rename workspace 1 to $w1 # always
	$exec $i3b/manager.sh init
# }}}
# {{{ workspace, assign, for_window
	# {{{ workspace variables
		set $w1 1:Talk
		set $w2 2:Web
		set $w3 3:Code
		set $w4 4:Misc
		set $w5 5:Video
		set $w6 6:School
		set $w7 7
		set $w8 8
		set $w9 9
		set $w0 10:Test
	# }}}
	# {{{ assign
		assign [class="TelegramDesktop"] $w1
		assign [class="discord"] $w1
		#assign [class="Firefox"] $w2 #TODO
		assign [class="Deluge"] $w4
		assign [class="Gimp"] $w4
		assign [title="^Oracle VM VirtualBox Manager$"] $w4
		assign [class="Steam"] $w5
		assign [title="Steam"] $w5
		#assign [title="DeSmuME"] $w5 #TODO
		assign [title="^School \[\w+\] - Oracle VM VirtualBox"] $w6
	# }}}
	# {{{ for_window
		for_window [title="^vimpc$"] floating enable
		for_window [title="^vimpc$"] sticky enable
		for_window [class="Pavucontrol"] floating enable
		for_window [class="Pavucontrol"] sticky enable
		for_window [title="^pulsemixer$"] floating enable
		for_window [title="^pulsemixer$"] sticky enable
	# }}}
# }}}
# {{{ decorations
	set $borders normal 0
	set $title   "%title"
	set $font    monospace 6
	#set $title   "<span></span>"
	#set $font    monospace 0

	for_window [title=".*"] title_format $title
	for_window [class=".*"] border $borders
	new_window $borders
	new_float $borders
	font pango:$font
# }}}
# {{{ colors
	#                       #edges  #body   #text   #split
	client.focused          #400040 #800080 #ffffff #0080ff
	client.focused_inactive #404040 #808080 #ffffff #0080ff
	client.unfocused        #202020 #404040 #aaaaaa #0080ff
	client.urgent           #804000 #ff8000 #000000 #0080ff
# }}}
# {{{ i3bar
	bindsym $mod+b       bar mode toggle
	bindsym $mod+Shift+b bar hidden_state toggle
	bar {
		font pango:monospace 8
		hidden_state show
		i3bar_command i3bar -t
		status_command i3blocks
		strip_workspace_numbers yes
		tray_output primary
		tray_padding 0
		colors { # {{{
			background #00000000
			statusline #ffffff
			separator  #ff8000
			#                  #edges    #body     #text
			focused_workspace  #800080   #800080   #ffffff
			inactive_workspace #404040   #404040   #ffffff
			urgent_workspace   #ff8000   #ff8000   #000000
		} # }}}
	}
# }}}
# {{{ general settings
	#floating_maximum_size 1000x750 #TODO
	#floating_minimum_size 300x350 #TODO
	workspace_layout stacking
	workspace_auto_back_and_forth yes
# }}}
# {{{ i3 controls
	bindsym $mod+Shift+c $exec $i3b/manager.sh reload
	bindsym $mod+Shift+r $exec $i3b/manager.sh restart
	bindsym $mod+c       $exec $i3b/manager.sh reload
	bindsym $mod+r       $exec $i3b/manager.sh restart
	bindsym $mod+Shift+q kill
	bindsym $mod+Control+Shift+q $exec "i3-nagbar \
	-t warning -m 'Exit i3?' \
	-b 'Yes, exit i3' '$i3b/manager.sh exit'
	# keyboard panic
	bindsym $mod+Escape $exec ~/.i3/bin/i3_keyswitch_nagbar.sh
# }}}
# {{{ movement
	#TODO: move?
	bindsym $mod+d [urgent=latest] focus
	# {{{ workspaces
		bindsym $mod+z                  workspace back_and_forth
		bindsym $mod+Shift+z            move container to workspace back_and_forth
		bindsym $mod+bracketleft        workspace prev_on_output
		bindsym $mod+bracketright       workspace next_on_output
		bindsym $mod+Shift+bracketleft  workspace prev
		bindsym $mod+Shift+bracketright workspace next
		bindsym $mod+1                  workspace number $w1
		bindsym $mod+2                  workspace number $w2
		bindsym $mod+3                  workspace number $w3
		bindsym $mod+4                  workspace number $w4
		bindsym $mod+5                  workspace number $w5
		bindsym $mod+6                  workspace number $w6
		bindsym $mod+7                  workspace number $w7
		bindsym $mod+8                  workspace number $w8
		bindsym $mod+9                  workspace number $w9
		bindsym $mod+0                  workspace number $w0
		bindsym $mod+Shift+1            move container to workspace number $w1
		bindsym $mod+Shift+2            move container to workspace number $w2
		bindsym $mod+Shift+3            move container to workspace number $w3
		bindsym $mod+Shift+4            move container to workspace number $w4
		bindsym $mod+Shift+5            move container to workspace number $w5
		bindsym $mod+Shift+6            move container to workspace number $w6
		bindsym $mod+Shift+7            move container to workspace number $w7
		bindsym $mod+Shift+8            move container to workspace number $w8
		bindsym $mod+Shift+9            move container to workspace number $w9
		bindsym $mod+Shift+0            move container to workspace number $w0
	# }}}
	# {{{ variables for directionals
		set $dir_mov Shift
		set $dir_r10 Mod1
		set $dir_r05 Shift+Mod1
		set $dir_swp Control
	# }}}
	# {{{ directionals
		# focus
		bindsym $mod+h          focus left
		bindsym $mod+j          focus down
		bindsym $mod+k          focus up
		bindsym $mod+l          focus right
		# move
		bindsym $mod+$dir_mov+h move left
		bindsym $mod+$dir_mov+j move down
		bindsym $mod+$dir_mov+k move up
		bindsym $mod+$dir_mov+l move right
		# resize 10
		bindsym $mod+$dir_r10+h resize shrink width  10 px or 10 ppt
		bindsym $mod+$dir_r10+j resize grow   height 10 px or 10 ppt
		bindsym $mod+$dir_r10+k resize shrink height 10 px or 10 ppt
		bindsym $mod+$dir_r10+l resize grow   width  10 px or 10 ppt
		# resize 5
		bindsym $mod+$dir_r05+h resize shrink width  5 px or 5 ppt
		bindsym $mod+$dir_r05+j resize grow   height 5 px or 5 ppt
		bindsym $mod+$dir_r05+k resize shrink height 5 px or 5 ppt
		bindsym $mod+$dir_r05+l resize grow   width  5 px or 5 ppt
		# swap
		bindsym $mod+$dir_swp+h mark A; focus left;  mark B; swap container with mark A; [con_mark="A"] focus; [con_mark="A"] unmark A; [con_mark="B"] unmark B
		bindsym $mod+$dir_swp+j mark A; focus down;  mark B; swap container with mark A; [con_mark="A"] focus; [con_mark="A"] unmark A; [con_mark="B"] unmark B
		bindsym $mod+$dir_swp+k mark A; focus up;    mark B; swap container with mark A; [con_mark="A"] focus; [con_mark="A"] unmark A; [con_mark="B"] unmark B
		bindsym $mod+$dir_swp+l mark A; focus right; mark B; swap container with mark A; [con_mark="A"] focus; [con_mark="A"] unmark A; [con_mark="B"] unmark B
	# }}}
	# {{{ tree
		bindsym $mod+g          focus parent
		bindsym $mod+Shift+g    focus child
		bindsym $mod+f          fullscreen
		bindsym $mod+Shift+f    fullscreen global
		# splits
		bindsym $mod+v          split t; layout tabbed
		bindsym $mod+Shift+v    split t; layout stacking
		bindsym $mod+w          split h
		bindsym $mod+Shift+w    split v
		bindsym $mod+t          layout tabbed
		bindsym $mod+Shift+t    layout stacking
		bindsym $mod+n          layout splith
		bindsym $mod+Shift+n    layout splitv
	# }}}
	# {{{ floating
		floating_modifier $mod
		bindsym $mod+s          focus mode_toggle
		bindsym $mod+Shift+s    floating toggle
		bindsym $mod+$alt+s     sticky toggle
	# }}}
	# {{{ scratchpad
		bindsym $mod+Shift+minus move scratchpad
		bindsym $mod+minus            scratchpad show
	# }}}
# }}}
# {{{ summoners
	bindsym $mod+Shift+Return         $exec urxvt -e zsh
	bindsym $mod+Control+Return       $exec urxvt -e tmx
	bindsym $mod+Control+Shift+Return $exec urxvt -e ranger
	# {{{ rofi
		bindsym $mod+backslash $exec rofi \
			-kb-row-select "Tab" -kb-row-tab "" \
			-modi run -show run
		bindsym $mod+Shift+backslash $exec rofi \
			-columns 1 \
			-kb-row-select "Tab" -kb-row-tab "" \
			-modi window -show window
	# }}}
# }}}
# {{{ media keys
	# {{{ screenshots
		set $print Print
		bindsym --release $print $exec ~/bin/shoot -s
		bindsym     Shift+$print $exec ~/bin/shoot
		bindsym   Control+$print $exec ~/bin/shoot -u
	# }}}
	# {{{ audio and mpd with arrow keys
		bindsym $mod+Up            $exec ~/bin/sound pa set +10 notify
		bindsym $mod+Down          $exec ~/bin/sound pa set -10 notify
		bindsym $mod+Left          $exec ~/bin/sound pa mute notify
		bindsym $mod+Right         $exec ~/bin/sound mpd player toggle
		#
		bindsym $mod+Shift+Up      $exec ~/bin/sound mpd vol +10
		bindsym $mod+Shift+Down    $exec ~/bin/sound mpd vol -10
		bindsym $mod+Shift+Left    $exec ~/bin/sound mpd player prev
		bindsym $mod+Shift+Right   $exec ~/bin/sound mpd player next
		#
		bindsym $mod+Control+Up    $exec ~/bin/sound mpd vol +10 ODROID
		bindsym $mod+Control+Down  $exec ~/bin/sound mpd vol -10 ODROID
		bindsym $mod+Control+Left  $exec ~/bin/sound mpd sat stop
		bindsym $mod+Control+Right $exec ~/bin/sound mpd sat start
		#
		bindsym $mod+$alt+Up       $exec ~/bin/sound mpd misc shuffle
		bindsym $mod+$alt+Down     $exec ~/bin/sound mpd misc repair
		bindsym $mod+$alt+Left     $exec ~/bin/sound pa get notify
		bindsym $mod+$alt+Right    $exec ~/bin/sound mpd player get
	# }}}
	# {{{ brightness
		bind $mod+87 $exec xbacklight -set 10
		bind $mod+88 $exec xbacklight -set 20
		bind $mod+89 $exec xbacklight -set 30
		bind $mod+83 $exec xbacklight -set 40
		bind $mod+84 $exec xbacklight -set 50
		bind $mod+85 $exec xbacklight -set 60
		bind $mod+79 $exec xbacklight -set 70
		bind $mod+80 $exec xbacklight -set 80
		bind $mod+81 $exec xbacklight -set 90
		bind $mod+91 $exec xbacklight -set 0
		bind $mod+90 $exec xbacklight -set 100
	# }}}
# }}}
# {{{ nop
	# Discord: push to talk
	bindsym $mod+$alt+space nop
	# libinput: trackball button scrolling
	bindsym button9 --whole-window nop
# }}}

#TODO
#mode "ABC" {
	#bindsym space exec espeak upper
	#bindsym Return mode "default"
#}

#mode "abc" {
	#bindsym space exec espeak lower
	#bindsym Return mode "default"
#}
#bindsym $mod+o mode "abc"
#bindsym $mod+Shift+o mode "ABC"
### The following was generated by vi3m.sh ###
bindsym $mod+Return mode "R-"
mode "R-" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "default"
	bindsym Shift+r $exec ~/bin/ssha; mode "default"
	bindsym a mode "R-a"
	bindsym g mode "R-g"
	bindsym i mode "R-i"
	bindsym m mode "R-m"
	bindsym r mode "R-r"
	bindsym t mode "R-t"
	bindsym w mode "R-w"
}

mode "R-a" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-"
	bindsym Shift+d $exec desmume; mode "default"
	bindsym Shift+f $exec firefox --private-window; mode "default"
	bindsym Shift+g $exec gimp ~/Pictures/Screenshots/Latest.png; mode "default"
	bindsym Shift+p $exec pavucontrol; mode "default"
	bindsym Shift+t $exec urxvt -e vim ~/Documents/todo.txt; mode "default"
	bindsym Shift+v $exec vlc; mode "default"
	bindsym d $exec discord; mode "default"
	bindsym f $exec firefox; mode "default"
	bindsym g $exec gimp; mode "default"
	bindsym l $exec libreoffice; mode "default"
	bindsym p $exec urxvt -e pulsemixer; mode "default"
	bindsym s $exec steam; mode "default"
	bindsym t $exec ~/bin/telegram; mode "default"
	bindsym u mode "R-au"
	bindsym v $exec VirtualBox; mode "default"
}

mode "R-au" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-a"
	bindsym Shift+f $exec ~/bin/feshot all; mode "default"
	bindsym f $exec ~/bin/feshot; mode "default"
}

mode "R-g" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-"
	bindsym f [class="Firefox"] focus; mode "default"
	bindsym g [class="Gimp"] focus; mode "default"
	bindsym t [class="TelegramDesktop"] focus; mode "default"
	bindsym v [class="Vlc"] focus; mode "default"
}

mode "R-i" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-"
	bindsym Shift+e $exec ~/.i3/bin/manager.sh edit main; mode "default"
	bindsym Shift+l $exec zsh -c "sleep .5 && xset dpms force off"; mode "default"
	bindsym e $exec ~/.i3/bin/manager.sh edit vi3m; mode "default"
	bindsym g $exec ~/.i3/bin/persistent_gaps.sh; mode "default"
	bindsym l $exec ~/.i3/bin/autolock_locker.sh; mode "default"
}

mode "R-m" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-"
	bindsym s $exec mpc stop; mode "default"
	bindsym t mode "R-mt"
	bindsym v $exec urxvt -e vimpc -h odroid; mode "default"
}

mode "R-mt" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-m"
	bindsym c $exec ~/bin/sound mpd toggle consume; mode "default"
	bindsym e $exec ~/bin/sound mpd toggle repeat; mode "default"
	bindsym r $exec ~/bin/sound mpd toggle random; mode "default"
	bindsym s $exec ~/bin/sound mpd toggle single; mode "default"
}

mode "R-r" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-"
	bindsym Shift+r $exec ~/bin/remote; mode "default"
	bindsym b $exec ~/bin/remote mosh bot -f -o cat -n 24; mode "default"
	bindsym d $exec ~/bin/remote tmuxd; mode "default"
	bindsym f $exec ~/bin/remote sshfs; mode "default"
	bindsym m $exec ~/bin/remote mosh; mode "default"
	bindsym p $exec ~/bin/remote ping; mode "default"
	bindsym r $exec ~/bin/remote ranger; mode "default"
	bindsym s $exec ~/bin/remote ssh; mode "default"
	bindsym t $exec ~/bin/remote tmux; mode "default"
	bindsym u $exec ~/bin/remote unmount; mode "default"
	bindsym v $exec ~/bin/remote vimpc; mode "default"
}

mode "R-t" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-"
	bindsym Shift+r $exec zsh -c "pkill -x redshift-gtk && redshift -O 5500 || redshift -O 5500"; mode "default"
	bindsym b $exec zsh -c "pgrep -x blueman-applet && pkill blueman-applet || blueman-applet"; mode "default"
	bindsym c $exec zsh -c "pgrep -x compton && pkill -x compton || compton -b"; mode "default"
	bindsym r $exec zsh -c "pgrep -x redshift-gtk && pkill -x redshift-gtk && redshift -x || redshift-gtk"; mode "default"
}

mode "R-w" {
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
	bindsym Control+bracketleft mode "default"
	bindsym $mod+Return mode "default"
	bindsym BackSpace mode "R-"
	bindsym m $exec i3-input -P "move to workspace " -F "move to workspace %s"; mode "default"
	bindsym o $exec i3-input -P "move workspace to output " -F "move workspace to output %s"; mode "default"
	bindsym r $exec i3-input -P "rename workspace to " -F "rename workspace to %s"; mode "default"
}

